{% from 'forms/form_widget.html' import form_field %}

{% for subfield in field %}
    <div class="i-radio i-linking form-subfield{% if has_error[subfield.data] %} has-error{% endif %}">
        {{ subfield() }}
        {{ subfield.label }}
        {% if subfield.data in form.conditional_fields %}
            {{ form_field(form[subfield.data], "i-linking-dropdown form-subfield") }}
        {% elif subfield.data == 'event' %}
            <span class='static-text'>{{ form.event.getTitle() }}</span>
        {% endif %}
    </div>
{% endfor %}
<script>
    $(function() {
        function update_dropdown_state(event) {
            var $this = $(this);
            if ($this.prop('checked')) {
                $this.closest('.i-radio').siblings('.i-radio').find('.i-linking-dropdown select').prop('disabled', true);
                $this.siblings('.i-linking-dropdown').find('select').prop('disabled', false);
            }
        }

        $('.i-linking > .i-linking-dropdown > select > option[value=""]').prop('disabled', true);

        $('.i-linking.i-radio input[type="radio"]')
            .off('change').on('change', update_dropdown_state)
            .each(update_dropdown_state);
    });
</script>
